
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>List Employee | Cashsnap</title>
      
      <!-- Favicon -->
      <link rel="shortcut icon" href="/assets/images/favicon.ico" />
      <link rel="stylesheet" href="/assets/css/backend-plugin.min.css">
      <link rel="stylesheet" href="/assets/css/backend.css?v=1.0.0">
      <link rel="stylesheet" href="/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css">
      <link rel="stylesheet" href="/assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css">
      <link rel="stylesheet" href="/assets/vendor/remixicon/fonts/remixicon.css">  </head>
      <body class="  ">
        <!-- loader Start -->
<div id="loading">
    <div id="loading-center">
    </div>
</div>
<!-- Wrapper Start -->
<div class="wrapper">
    <div class="iq-sidebar  sidebar-default ">
        <div class="iq-sidebar-logo d-flex align-items-center justify-content-between">
            <a href="/dashboard.html" class="header-logo">
                <img src="/assets/images/logo.png" class="img-fluid rounded-normal light-logo" alt="logo">
                <h5 class="logo-title light-logo ml-3">Cashsnap</h5>
            </a>
            <div class="iq-menu-bt-sidebar ml-0">
                <i class="las la-bars wrapper-menu"></i>
            </div>
        </div>
        <div class="data-scrollbar" data-scroll="1">
            <nav class="iq-sidebar-menu">
                <ul id="iq-sidebar-toggle" class="iq-menu">
                    <li class="">
                        <a href="/dashboard.html" class="svg-icon">
                            <svg class="svg-icon" id="p-dash1" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z">
                                </path>
                                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                <line x1="12" y1="22.08" x2="12" y2="12"></line>
                            </svg>
                            <span class="ml-4">Dashboard</span>
                        </a>
                    </li>
                    <li class="">
                        <a href="/calculator.html">
                            <svg class="svg-icon" id="p-dash18" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M21 12C21 16.714 21 19.0711 19.682 20.5355C18.364 22 16.2426 22 12 22C7.75736 22 5.63604 22 4.31802 20.5355C3 19.0711 3 16.714 3 12C3 7.28595 3 4.92893 4.31802 3.46447C5.63604 2 7.75736 2 12 2C16.2426 2 18.364 2 19.682 3.46447C20.5583 4.43821 20.852 5.80655 20.9504 8" />
                                <path
                                    d="M7 8C7 7.53501 7 7.30252 7.05111 7.11177C7.18981 6.59413 7.59413 6.18981 8.11177 6.05111C8.30252 6 8.53501 6 9 6H15C15.465 6 15.6975 6 15.8882 6.05111C16.4059 6.18981 16.8102 6.59413 16.9489 7.11177C17 7.30252 17 7.53501 17 8C17 8.46499 17 8.69748 16.9489 8.88823C16.8102 9.40587 16.4059 9.81019 15.8882 9.94889C15.6975 10 15.465 10 15 10H9C8.53501 10 8.30252 10 8.11177 9.94889C7.59413 9.81019 7.18981 9.40587 7.05111 8.88823C7 8.69748 7 8.46499 7 8Z" />
                                <circle cx="8" cy="13" r="1" fill="#1C274D" />
                                <circle cx="8" cy="17" r="1" fill="#1C274D" />
                                <circle cx="12" cy="13" r="1" fill="#1C274D" />
                                <circle cx="12" cy="17" r="1" fill="#1C274D" />
                                <circle cx="16" cy="13" r="1" fill="#1C274D" />
                                <circle cx="16" cy="17" r="1" fill="#1C274D" />
                            </svg>
                            <polyline points="13 2 13 9 20 9"></polyline>
                            </svg>
                            <span class="ml-4">Calculator</span>
                        </a>
                    </li>
                    <li class="">
                        <a href="/page-transaction.html">
                            <svg class="svg-icon" id="p-dash7" width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            <span class="ml-4">Transaction</span>
                        </a>
                    </li>
                    <li class="">
                        <a href="#product" class="collapsed" data-toggle="collapse" aria-expanded="false">
                            <svg class="svg-icon" id="p-dash2" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="9" cy="21" r="1"></circle>
                                <circle cx="20" cy="21" r="1"></circle>
                                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                            </svg>
                            <span class="ml-4">Products</span>
                            <svg class="svg-icon iq-arrow-right arrow-active" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <polyline points="10 15 15 20 20 15"></polyline>
                                <path d="M4 4h7a4 4 0 0 1 4 4v12"></path>
                            </svg>
                        </a>
                        <ul id="product" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                            <li class="">
                                <a href="/page-list-product.html">
                                    <i class="las la-minus"></i><span>List Product</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/page-add-product.html">
                                    <i class="las la-minus"></i><span>Add Product</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    
                    <li class=" ">
                        <a href="#return" class="collapsed" data-toggle="collapse" aria-expanded="false">
                            <svg class="svg-icon" id="p-dash6" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <polyline points="4 14 10 14 10 20"></polyline>
                                <polyline points="20 10 14 10 14 4"></polyline>
                                <line x1="14" y1="10" x2="21" y2="3"></line>
                                <line x1="3" y1="21" x2="10" y2="14"></line>
                            </svg>
                            <span class="ml-4">Returns</span>
                            <svg class="svg-icon iq-arrow-right arrow-active" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <polyline points="10 15 15 20 20 15"></polyline>
                                <path d="M4 4h7a4 4 0 0 1 4 4v12"></path>
                            </svg>
                        </a>
                        <ul id="return" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                            <li class="">
                                <a href="/page-list-returns.html">
                                    <i class="las la-minus"></i><span>List Returns</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/page-add-return.html">
                                    <i class="las la-minus"></i><span>Add Return</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="active">
                        <a href="#people" class="collapsed" data-toggle="collapse" aria-expanded="false">
                            <svg class="svg-icon" id="p-dash8" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            <span class="ml-4">People</span>
                            <svg class="svg-icon iq-arrow-right arrow-active" width="20" height="20"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <polyline points="10 15 15 20 20 15"></polyline>
                                <path d="M4 4h7a4 4 0 0 1 4 4v12"></path>
                            </svg>
                        </a>
                        <ul id="people" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                            <li class="">
                                <a href="/page-list-customers.html">
                                    <i class="las la-minus"></i><span>Customers</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/page-add-customers.html">
                                    <i class="las la-minus"></i><span>Add Customers</span>
                                </a>
                            </li>
                            <li class="active">
                                <a href="/page-list-employee.html">
                                    <i class="las la-minus"></i><span>Employee</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/page-add-employee.html">
                                    <i class="las la-minus"></i><span>Add Employee</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/page-list-suppliers.html">
                                    <i class="las la-minus"></i><span>Suppliers</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/page-add-supplier.html">
                                    <i class="las la-minus"></i><span>Add Suppliers</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <div class="p-3"></div>
                </ul>   
            </nav>  
        </div>
    </div>
    <div class="iq-top-navbar">
        <div class="iq-navbar-custom">
          <nav class="navbar navbar-expand-lg navbar-light p-0">
              <div class="iq-navbar-logo d-flex align-items-center justify-content-between">
                  <i class="ri-menu-line wrapper-menu"></i>
                  <a href="/dashboard.html" class="header-logo">
                      <img src="/assets/images/logo.png" class="img-fluid rounded-normal" alt="logo">
                      <h5 class="logo-title ml-3">Cashsnap</h5>
  
                  </a>
              </div>
              <div class="iq-search-bar device-search">
                  <form action="#" class="searchbox">
                      <a class="search-link" href="#"><i class="ri-search-line"></i></a>
                      <input type="text" class="text search-input" placeholder="Search here.">
                  </form>
              </div>
              <div class="d-flex align-items-center">
                  <button class="navbar-toggler" type="button" data-toggle="collapse"
                      data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                      aria-label="Toggle navigation">
                      <i class="ri-menu-3-line"></i>
                  </button>
                  <div class="collapse navbar-collapse" id="navbarSupportedContent">
                      <ul class="navbar-nav ml-auto navbar-list align-items-center">
                          <li class="nav-item nav-icon dropdown caption-content">
                              <a href="#" class="search-toggle dropdown-toggle" id="dropdownMenuButton4"
                                  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                  <img src="/assets/images/user/1.png" class="img-fluid rounded" alt="user">
                              </a>
                              <div class="iq-sub-dropdown dropdown-menu" aria-labelledby="dropdownMenuButton">
                                  <div class="card shadow-none m-0">
                                      <div class="card-body p-0 text-center">
                                          <div class="media-body profile-detail text-center">
                                              <img src="/assets/images/page-img/profile-bg.jpg" alt="profile-bg"
                                                  class="rounded-top img-fluid mb-4">
                                              <img src="/assets/images/user/1.png" alt="profile-img"
                                                  class="rounded profile-img img-fluid avatar-70">
                                          </div>
                                          <div class="p-3">
                                            <h5 id="msgmail" class="mb-1">example@xyz.com</h5>
                                              <!-- <p class="mb-0">Since 10 march, 2020</p> -->
                                              <div class="d-flex align-items-center justify-content-center mt-3">
                                                  <a href="" class="btn border mr-2">Profile</a>
                                                  <a id="SignOutbtn" href="auth-sign-in-up.html" class="btn border">Sign Out</a>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </li>
                      </ul>
                  </div>
              </div>
          </nav>
      </div>
  </div>
    <div class="content-page">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="d-flex flex-wrap align-items-center justify-content-between mb-4">
                        <div>
                            <h4 class="mb-3">Employee</h4>
                            <p class="mb-0">A dashboard provides you an overview of employee list with access to the most important data,<br>
                                functions and controls. </p>
                        </div>
                        <div>
                            <a href="page-add-employee.html" class="btn btn-primary add-list mr-3"><i class="las la-plus mr-3"></i>Add Employee</a>
                            <button id="refreshButton" class="btn btn-secondary"><i class="las la-sync-alt mr-2"></i>Refresh</button>
                        </div>
                        
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="table-responsive rounded mb-3">
                        <table class="data-table table mb-0 tbl-server-info">
                            <thead class="bg-white text-uppercase">
                                <tr class="ligth ligth-data">
                                    <th>Name</th>
                                    <th>EmployeeId</th>
                                    <th>Phone No.</th>
                                    <th>Email</th>
                                    <th>Gender</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody class="ligth-body" id="employeeTableBody">
                                <!-- Employees will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- Page end  -->
        </div>
    </div>
    <!-- Modal HTML -->
    <div class="modal fade" id="employeeDetailsModal" tabindex="-1" aria-labelledby="employeeDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="employeeDetailsModalLabel">Employee Details</h5>

                </div>
                <div class="modal-body">
                    <ul class="list-group">
                        <li class="list-group-item"><strong>Date:</strong> <span id="modalDate"></span></li>
                        <li class="list-group-item"><strong>Time:</strong> <span id="modalTime"></span></li>
                        <li class="list-group-item"><strong>Name:</strong> <span id="modalName"></span></li>
                        <li class="list-group-item"><strong>Employee ID:</strong> <span id="modalEmployeeId"></span></li>
                        <li class="list-group-item"><strong>Phone Number:</strong> <span id="modalPhonenumber"></span></li>
                        <li class="list-group-item"><strong>Email:</strong> <span id="modalEmail"></span></li>
                        <li class="list-group-item"><strong>Gender:</strong> <span id="modalGender"></span></li>
                        <li class="list-group-item"><strong>Status:</strong> <span id="modalStatus"></span></li>
                    </ul>
                </div>

            </div>
        </div>
    </div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, collection, getDocs, doc, getDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBncdnP33SF5gVSACcn2DI7DMZ-eIF3hj4",
        authDomain: "cashsnap-9a185.firebaseapp.com",
        projectId: "cashsnap-9a185",
        storageBucket: "cashsnap-9a185.appspot.com",
        messagingSenderId: "1046320871049",
        appId: "1:1046320871049:web:600b3dee8af7b3c4763858",
        measurementId: "G-5M366WH052"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    let currentUser = null;

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            currentUser = user;
            await loadEmployees();
        } else {
            alert("Please sign in to view employees.");
        }
    });

    async function loadEmployees() {
        if (!currentUser) {
            alert("Please sign in to view employees.");
            return;
        }

        try {
            const userDocRef = collection(db, "Data", currentUser.uid, "employee");
            const employeeSnapshot = await getDocs(userDocRef);
            const employeeTableBody = document.getElementById("employeeTableBody");
            employeeTableBody.innerHTML = ""; // Clear any existing rows

            employeeSnapshot.forEach((doc) => {
                const employeeData = doc.data();
                const employeeRow = document.createElement("tr");

                employeeRow.innerHTML = `
                    <td>${employeeData.Name || "N/A"}</td>
                    <td>${employeeData.EmployeeId}</td>
                    <td>${employeeData.Phonenumber || "N/A"}</td>
                    <td>${employeeData.Email || "N/A"}</td>
                    <td>${employeeData.Gender || "N/A"}</td>
                    <td>${employeeData.Status || "N/A"}</td>
                    
                    <td>
                        <div class="d-flex align-items-center list-action">
                            <a class="badge badge-info mr-2 view-employee" data-toggle="tooltip" data-placement="top" title="View" href="#" data-employee-id="${doc.id}"><i class="ri-eye-line mr-0"></i></a>
                            <a class="badge bg-success mr-2" data-toggle="tooltip" data-placement="top" title="Edit" href="page-edit-employee.html?employeeId=${doc.id}">
                                <i class="ri-pencil-line mr-0"></i>
                            </a>
                            <a class="badge bg-warning mr-2 delete-employee" data-toggle="tooltip" data-placement="top" title="Delete" href="#" data-employee-id="${doc.id}"><i class="ri-delete-bin-line mr-0"></i></a>
                        </div>
                    </td>
                `;

                employeeTableBody.appendChild(employeeRow);
            });

            // Attach event listeners for delete buttons
            const deleteButtons = document.querySelectorAll(".delete-employee");
            deleteButtons.forEach(button => {
                button.addEventListener("click", async (event) => {
                    event.preventDefault();
                    const employeeId = button.getAttribute("data-employee-id");
                    await deleteEmployee(employeeId);
                });
            });

            // Attach event listeners for view buttons
            const viewButtons = document.querySelectorAll(".view-employee");
            viewButtons.forEach(button => {
                button.addEventListener("click", async (event) => {
                    event.preventDefault();
                    const employeeId = button.getAttribute("data-employee-id");
                    await viewEmployeeDetails(employeeId);
                });
            });
        } catch (error) {
            console.error("Error loading employees:", error);
            alert("Failed to load employees. Please try again.");
        }
    }

    async function viewEmployeeDetails(employeeId) {
        if (!currentUser) {
            alert("Please sign in to view employee details.");
            return;
        }

        try {
            const employeeRef = doc(db, "Data", currentUser.uid, "employee", employeeId);
            const employeeDoc = await getDoc(employeeRef);

            if (employeeDoc.exists()) {
                const employeeData = employeeDoc.data();
                document.getElementById("modalDate").innerText = employeeData.Date;
                document.getElementById("modalTime").innerText = employeeData.Time;
                document.getElementById("modalName").innerText = employeeData.Name;
                document.getElementById("modalEmployeeId").innerText = employeeData.EmployeeId;
                document.getElementById("modalPhonenumber").innerText = employeeData.Phonenumber;
                document.getElementById("modalEmail").innerText = employeeData.Email;
                document.getElementById("modalGender").innerText = employeeData.Gender;
                document.getElementById("modalStatus").innerText = employeeData.Status;

                // Show the modal
                const employeeDetailsModal = new bootstrap.Modal(document.getElementById('employeeDetailsModal'));
                employeeDetailsModal.show();
            } else {
                alert("No such employee found.");
            }
        } catch (error) {
            console.error("Error fetching employee details:", error);
            alert("Failed to fetch employee details. Please try again.");
        }
    }

    async function deleteEmployee(employeeId) {
        if (!currentUser) {
            alert("Please sign in to delete employees.");
            return;
        }

        try {
            const employeeRef = doc(db, "Data", currentUser.uid, "employee", employeeId);
            await deleteDoc(employeeRef);
            alert("Employee deleted successfully.");
            await loadEmployees(); // Refresh the employee list
        } catch (error) {
            console.error("Error deleting employee:", error);
            alert("Failed to delete employee. Please try again.");
        }
    }

    document.getElementById("refreshButton").addEventListener("click", loadEmployees);
</script>

    

    
    <script src="/assets/js/login.js"></script>
    <script src="/assets/js/firebaseconfig.js"></script>
    <script src="/assets/js/dashboard.js"></script>
    <script src="/assets/js/backend-bundle.min.js"></script>
    <script src="/assets/js/table-treeview.js"></script>
    <script src="/assets/js/customizer.js"></script>
    <script async src="/assets/js/chart-custom.js"></script>
    <script src="/assets/js/app.js"></script>
  </body>
</html>